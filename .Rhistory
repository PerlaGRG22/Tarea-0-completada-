install.packages("BIOCONDUCTOR")
library(BiocGenerics)
library(Biobase)
library(BiocIO)
library(Biostrings)
library(BiocManager)
library(BiocParallel)
library(BiocVersion)
##CARGO MI SECUENCIA
sec<- readDNAStringSet("first (1).fasta")
sec
###1. PARA CONTAR LOS NUCLEOTIDOS CON LIBRERIA ESPECIALIZADA
counts(sec)
###1. PARA CONTAR LOS NUCLEOTIDOS CON LIBRERIA ESPECIALIZADA
##width(), nchar(): numero de caracteres en una secuencia
width(sec)
###1. PARA CONTAR LOS NUCLEOTIDOS CON LIBRERIA ESPECIALIZADA
alphabetFrequency(sec)
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec)
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec$secuencia1, "CG", "GC")
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec$secuencia1, "CG", "GC", as.prob = TRUE
)
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec$secuencia4, "CG", "GC", as.prob = TRUE      )
# Calcular contenido de GC con libreria especializada
letterFrequency(sec$secuencia4, "CG", "GC", as.prob = TRUE      )
# Calcular contenido de GC con libreria especializada
letterFrequency(sec$secuencia4, "GC", as.prob = TRUE      )
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec$secuencia4, "GC", as.prob = TRUE      )
# Calcular contenido de GC con libreria especializada
dinucleotideFrequencyTest(sec)
# Calcular contenido de GC con libreria especializada
dinucleotideFrequencyTest(sec$secuencia3)
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec)
#esta funcion me permite observar la frecuencia de mis dinucleotidos, entre ellos el GC, CG
##tambien puedo optar por letterfrecuency y delimitar mis letras de interes "GC"
letterFrequency(sec, "GC", as.prob = TRUE)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
gc<- function(x){dinucleotideFrequency(x)["GC"] *100 / length(x)}
gc(v1)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
gc<- function(x){dinucleotideFrequency(x)["GC"] *100 / length(x)}
gc
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
dinucleotideFrequency(sec$secuencia1["GC"]*100/length(sec$secuencia1))
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
x<- oligonucleotideFrequency(sec$secuencia1["GC"]*100/length(sec$secuencia1))
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
x<- oligonucleotideFrequency(sec$secuencia1["GC"]*100/length(sec$secuencia1))
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
x<- dinucleotideFrequency(sec$secuencia1["GC"]*100/length(sec$secuencia1))
gc<- function(x){dinucleotideFrequency(x)["GC"] *100 / length(x)}
gc(v1)
w<-function(x){dinucleotideFrequency(x)["GC"] *100 / length(x)}
w(sec$secuencia1)
#esta funcion me permite observar la frecuencia de mis dinucleotidos, entre ellos el GC, CG
##tambien puedo optar por letterfrecuency y delimitar mis letras de interes "GC", y obtengo el porcentaje
#por cadena de mi cintenido de GC
letterFrequency(sec, "GC", as.prob = TRUE)
w(sec$secuencia2)
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec)
matriz_dist <- c(distancia2(v1,v1),distancia2(v1,v2),distancia2(v1,v3),distancia2(v1,v4),
distancia2(v1,v5))
matriz_dist<- as.matrix(matriz_dist)
matriz_dist<- cbind(matriz_dist,d2,d3,d4,d5)
###1. PARA CONTAR LOS NUCLEOTIDOS CON LIBRERIA ESPECIALIZADA
alphabetFrequency(sec)
###PARA CONTAR LOS NUCLEOTIDOS SIN LIBRERIA ESECIALIADA
counts(sec)
aminoacidos<- AAStringSet(c("AARNC", "EDEHA"))
aminoacidos
nchar(sec)
###1. PARA CONTAR LOS NUCLEOTIDOS CON LIBRERIA ESPECIALIZADA
alphabetFrequency(sec)
secuencias<- c("insulina.fasta")
secuencias<- readAAStringSet(secuencias)
v1<-(secuencias$`NP_001123565.1 insulin precursor [Canis lupus familiaris]`)
v2<-(secuencias$`NP_000198.1 insulin preproprotein [Homo sapiens]`)
v3<-(secuencias$`NP_001008996.1 insulin preproprotein [Pan troglodytes]`)
v4<-(secuencias$`NP_062003.1 insulin-2 preproprotein [Rattus norvegicus]`)
v5<-(secuencias$`NP_001172013.1 insulin-2 preproprotein [Mus musculus]`)
matriz_dist <- c(distancia2(v1,v1),distancia2(v1,v2),distancia2(v1,v3),distancia2(v1,v4),
distancia2(v1,v5))
matriz_dist<- as.matrix(matriz_dist)
nchar(sec)
###PARA CONTAR LOS NUCLEOTIDOS SIN LIBRERIA ESECIALIADA
x <- c("asfef", "qwerty", "yuiop[", "b", "stuff.blah.yech")
nchar(x)
nchar(deparse(mean))
x[3] <- NA; x
nchar(x, keepNA= TRUE) #  5  6 NA  1 15
nchar(x, keepNA=FALSE) #  5  6  2  1 15
stopifnot(identical(nchar(x     ), nchar(x, keepNA= TRUE)),
identical(nchar(x, "w"), nchar(x, keepNA=FALSE)),
identical(is.na(x), is.na(nchar(x))))
k<-stopifnot(identical(nchar(x     ), nchar(x, keepNA= TRUE)),
identical(nchar(x, "w"), nchar(x, keepNA=FALSE)),
identical(is.na(x), is.na(nchar(x))))
k
nchars("\u200b")
nchars <- function(x, ...)
vapply(c("chars", "bytes", "width"),
function(tp) nchar(x, tp, ...), integer(length(x)))
nchars("\u200b")
tp
nchars <- function(x, ...)
vapply(c("chars", "bytes", "width"),
function(s) nchar(x, s, ...), integer(length(x)))
nchars("\u200b")
nchars <- function(x, ...)
vapply(c("chars", "bytes", "width"),
function(s) nchar(x, s, ...), integer(length(x)))
nchars("sec")
nchars("h")
nchars("t")
###PARA CONTAR LOS NUCLEOTIDOS SIN LIBRERIA ESECIALIADA
width(sec)
nchar(sec)
###PARA CONTAR LOS NUCLEOTIDOS SIN LIBRERIA ESECIALIADA
x <- c("manzana", "banana", "pera")
str_view(x, "an")
###PARA CONTAR LOS NUCLEOTIDOS SIN LIBRERIA ESECIALIADA
library(tidyverse)
library(datos)
x <- c("manzana", "banana", "pera")
str_view(x, "an")
substr("na", x)
grep("na", x)
Grep("na", x)
str_count(sec$secuencia0, "A")
###1. PARA CONTAR LOS NUCLEOTIDOS CON LIBRERIA ESPECIALIZADA
alphabetFrequency(sec)
str_count(sec$secuencia0, "A", "T")
str_count(sec$secuencia0, "A")
###PARA CONTAR LOS NUCLEOTIDOS SIN LIBRERIA ESECIALIADA
#La funcion "str_count" cuenta el # de veces que aparece un caracter en una cadena, por lo que
# usare este comando para encontrar el # de veces que aparecen mis nucelotidos en mis cadenas
#y posteriormente procedere a llenar una matriz con los resultados
str_count(sec, "A")
t<-str_count(sec, "T")
###PARA CONTAR LOS NUCLEOTIDOS SIN LIBRERIA ESECIALIADA
#La funcion "str_count" cuenta el # de veces que aparece un caracter en una cadena, por lo que
# usare este comando para encontrar el # de veces que aparecen mis nucelotidos en mis cadenas
#y posteriormente procedere a llenar una matriz con los resultados
A<-str_count(sec, "A")# obtengo los resultados de la frecuencia del na "A" en mis 5 cadenas
t<-str_count(sec, "T")
G<- str_count(sec, "G")
C<- str_count(sec, "C")
#ahora procedo a crear mi matriz con los resultados
matr<- cbind.data.frame(A,t,G,C)
matr
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias
GC<- str_count(sec,"GC")
Gc
#esta funcion me permite observar la frecuencia de mis dinucleotidos, entre ellos el GC, CG
##tambien puedo optar por letterfrecuency y delimitar mis letras de interes "GC", y obtengo el porcentaje
#por cadena de mi cintenido de GC
letterFrequency(sec, "GC", as.prob = TRUE)
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias
GC<- str_count(sec,c ("G", "C"))
Gc
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias
GC<- str_count(sec,c ("G","C"))
Gc
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias
GC<- str_count(sec, c("G","C"))
Gc
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias
mean(str_count(sec, "[aeiou]"))
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias
mean(str_count(sec, "[GC]"))
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
str_count(sec, "[GC]")
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
GC<- '(G|C)'
grep(pattern = GC, sec, value = T)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
GC<- '(G|C)'*
grep(pattern = GC, sec, value = T)
w<-function(x){dinucleotideFrequency(x)["GC"] *100 / length(x)}  #creo una funcion que me permita
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
GC<- '(G|C)*'
grep(pattern = GC, sec, value = T)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
GC<- '(G|C)+'
GC
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
GC<- '(G|C)+'
grep(pattern = GC, sec, value = T)
#esta funcion me permite observar la frecuencia de mis dinucleotidos, entre ellos el GC, CG
##tambien puedo optar por letterfrecuency y delimitar mis letras de interes "GC", y obtengo el porcentaje
#por cadena de mi cintenido de GC
letterFrequency(sec, "GC", as.prob = TRUE)
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec)
grep(pattern = GC, sec, value = T)
grep(pattern = GC, sec, value = T)
#esta funcion me permite observar la frecuencia de mis dinucleotidos, entre ellos el GC, CG
##tambien puedo optar por letterfrecuency y delimitar mis letras de interes "GC", y obtengo el porcentaje
#por cadena de mi cintenido de GC
letterFrequency(sec, "GC", as.prob = TRUE)
str_extract_all(sec, "[A-T]", simplify = TRUE)
count(sec, "A")
x<-str_extract_all(sec, "[A-T]", simplify = TRUE)
count(x, "A")
class(x)
sec  %>% count(A)
x<-str_extract_all(sec, "[A-T]", simplify = TRUE)
class(x)
x<- as.data.frame(x)
class(x)
x
sec  %>% count(A)
x<-str_extract_all(sec, "[A-T]", simplify = TRUE)
x<- as.data.frame(x)
x<-str_extract_all(sec, "[A-T]", simplify = TRUE)
x<-str_extract_all(sec, "[A-T]", simplify = TRUE)
x
x<-str_extract_all(sec, "[A-Z]", simplify = TRUE)
x
sec
count(sec$secuencia0, "A")
x<-str_extract_all(sec, "[A-Z]", simplify = TRUE)
x
GC_fun<- function (x){grep(pattern = GC, sec, value = T)}
grep(pattern = GC, sec, value = T)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
GC<-str_count(sec,'(G|C)+' )
GC
# Calcular contenido de GC con libreria especializada
dinucleotideFrequency(sec)
GC_fun<- function (x){grep(pattern = GC, sec, value = T)}
GC<- '(G|C)+' #
grep(pattern = GC, sec, value = T)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
GC<-str_count(sec,'(G|C)+' )
GC
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias, pero con la
GC<-str_count(sec,'(G|C)' )
GC
GC<- '(G|C)' #
GC_fun<- function (x){grep(pattern = GC, sec, value = T)}
grep(pattern = GC, sec, value = T)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias
GC<-str_count(sec,'(G|C)' )
GC #Visualio las frecuencias por secuencia
grep(pattern = GC, sec, value = T)#Visualio las secuencias que tienen estos nc
GC_fun<- function (x){GC<-str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0)
GC_fun(sec$secuencia0)
GC* 100/length(sec)
GC_fun<- function (x){GC<-str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0)
w<-function(x){dinucleotideFrequency(x)["GC"] *100 / length(x)}  #creo una funcion que me permita
sec
GC_fun(sec)
GC_fun
GC_fun<- function (x){
GC<-str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0)
GC_fun<- function (){
GC<-str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0)
GC_fun<- function (x){
GC<-str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0)
GC_fun<- function (x...){
GC<-str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0)
GC<-str_count(sec$secuencia0,'(G|C)' )
GC
GC0<-str_count(sec$secuencia0,'(G|C)' )
GC0*100/length(sec$secuencia0)
GC_fun<- function (x...){
str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0)
GC_fun<- function (x...){
str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec)
GC0<-str_count(sec$secuencia0,'(G|C)' )
GC0*100/length(sec$secuencia0)
GC_fun<- function (x...){
str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec)
##CALCULAR CONTENIDO DE GC SIN LIBRERIA ESPECIALIZADA
#utilizaré la vieja confiable str_count para buscar la frecuencia de GC en mis secuencias
GC<-str_count(sec,'(G|C)' )
GC #Visualio las frecuencias por secuencia
GC0<-str_count(sec$secuencia0,'(G|C)' )
str_count(x,'(G|C)' )* 100/length(x)}
GC_fun<- function (x...){
str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0)
GC_fun<- function (x...){
str_count(sec$secuencia0,'(G|C)' )* 100/length(sec$secuencia0)}
GC_fun(sec$secuencia1)
GC_fun<- function (x...){
str_count(sec,'(G|C)' )* 100/length(sec)}
GC_fun(sec)
GC_fun(sec$secuencia0)
GC_fun<- function (x...){
str_count(y,'(G|C)' )* 100/length(y)}
GC_fun(sec)
GC_fun<- function (x...){
str_count(w,'(G|C)' )* 100/length(w)}
GC_fun(sec)
GC_fun<- function (x){
str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec)
GC_fun(sec$secuencia2)
GC2<-str_count(sec$secuencia2,'(G|C)' )
GC2*100/length(sec$secuencia2)
#esta funcion me permite observar la frecuencia de mis dinucleotidos, entre ellos el GC, CG
##tambien puedo optar por letterfrecuency y delimitar mis letras de interes "GC", y obtengo el porcentaje
#por cadena de mi cintenido de GC
letterFrequency(sec, "GC", as.prob = TRUE)
#Para calcular el % creo una funcion que me ayude
GC_fun<- function (x){ #con esta funcion le digo a R que a cad cadena que ingrese, le cuente las G y C
#y posteriormente multiplique esa frecuencia por 100 y el resultado lo divida entre la longitud de la cadena
# y asi obtenemos el porcentaje de GC de nuestra secuencia sin tener que escribir lo mismo para todas las cadenas
# solo ingresar mi cadena de interes a la funcion
str_count(x,'(G|C)' )* 100/length(x)}
GC_fun(sec$secuencia0) #visualizo el % de GC de i cadena 1
GC_fun(sec$secuencia1)
GC_fun(sec$secuencia2)
GC_fun(sec$secuencia3)
GC_fun(sec$secuencia4)
GC_fun(sec)
